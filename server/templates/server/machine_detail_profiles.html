{% extends "base.html" %}
{% load i18n %}
{% load dashboard_extras %}

{% block title %}Sal - {{ machine.hostname }}{% endblock %}

{% block script %}
<script type="text/javascript" charset="utf-8">
    $(document).ready(function() {
        $('.groupList').DataTable({
            "pageLength": {{ page_length }},
            "lengthMenu": [[20, 50, -1], [20, 50, "All"]],
            'columnDefs': [{
                'orderable': false,
                'targets': [-1, -2] /* 1st one, start by the right */
            }]
        });
    } );
</script>
{% endblock %}

{% block nav %}{% include 'server/machine_detail_nav.html' %}{% endblock %}

{% block content %}
<div class="panel panel-default">
{% if title %}
    <div class="panel-heading">{{ title }}</div>
{% endif %}
<div class="panel-body">
  <div class="table-responsive">
    <table class="groupList table table-striped table-condensed">
      <thead>
        <tr>
          <th>Display Name</th>
          <th>Description</th>
          <th>Install Date</th>
          <th>Organization</th>
          <th>Identifier</th>
          <th>UUID</th>
          <th>Verification State</th>
        </tr>
      </thead>
      <tbody>
        {% for item in table_data %}
        <tr>
          <td>
            <a href="#ProfileModal-{{ item.uuid }}" data-toggle="modal" data-backdrop="true">{{ item.display_name }}</a>
          </td>
          <td>{{ item.description }}</td>
          <td>{{ item.install_date }}</td>
          <td>{{ item.organization }}</td>
          <td>{{ item.identifier }}</td>
          <td>{{ item.uuid }}</td>
          <td>{{ item.verification_state }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}

{% block modal %}
  <!-- Profile Modals -->
  {% for profile in table_data %}
    <!-- {{ profile.uuid }} Modal -->
    <div class="modal fade in" id="ProfileModal-{{ profile.uuid}}" tabindex="-1" role="dialog" aria-labelledby="labelProfileModal-{{ profile.uuid }}" aria-hidden="true">
      <div class="modal-dialog" style="width: 60%">
        <!-- modal-content -->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="labelProfileModal-{{ profile.uuid }}">Details for {{ profile.display_name }}</h4>
          </div>
          <div class="modal-body">
            {% for item in profile.payload_set.all %}
              <dl class="dl-horizontal">
                <dt>payload type</dt>
                <dd>{{ item.payload_type }}</dd>
                <dt>identifier</dt>
                <dd>{{ item.identifier }}</dd>
                <dt>uuid</dt>
                <dd>{{ item.uuid }}</dd>
              </dl>
              <hr/>
            {% endfor %}

            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
          <!-- /.modal-body -->
        </div>
        <!-- /.modal-content -->
      </div>
      <!-- /.modal-dialog -->
    </div>
    <!-- /.modal -->
  {% endfor %}
{% endblock %}
